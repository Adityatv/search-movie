<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>CRIXZY MOVIES</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://unpkg.com/lucide@latest"></script>

<style>
body { background:#020617; font-family:Inter,sans-serif; }
</style>
</head>

<body class="text-slate-100">

<main class="max-w-7xl mx-auto px-4 py-6">
  <input id="searchInput"
    class="w-full p-4 rounded-xl bg-slate-900 border border-white/10"
    placeholder="Search movies..." />

  <div id="movieGrid"
    class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mt-6">
  </div>
</main>

<script>
lucide.createIcons();

let allMovies = [];

fetch("movies.json")
.then(r=>r.json())
.then(d=>{
  allMovies = d;
  render(allMovies.slice(0,20));
});

function openTelegram(message){
  const text = encodeURIComponent(message);

  const tgApp = `tg://msg?text=${text}`;
  const tgWeb = `https://t.me/share/url?text=${text}`;

  // Try Telegram app first
  window.location.href = tgApp;

  // Fallback to web after short delay
  setTimeout(() => {
    window.open(tgWeb, "_blank");
  }, 600);
}

function render(list){
  movieGrid.innerHTML = list.map(m=>{
    const name = Array.isArray(m)?m[1]:m.name;

    return `
    <div class="bg-slate-900 p-5 rounded-2xl border border-white/10">
      <h3 class="font-bold mb-4">${name}</h3>
      <button
        onclick="openTelegram('/movie ${name}')"
        class="w-full bg-white text-black font-black py-3 rounded-xl active:scale-95">
        Get File
      </button>
    </div>`;
  }).join("");
}

searchInput.oninput = e => {
  const q = e.target.value.toLowerCase();
  const res = allMovies.filter(m =>
    (Array.isArray(m)?m[1]:m.name).toLowerCase().includes(q)
  );
  render(res.slice(0,40));
};
</script>

</body>
</html>
